<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>SuperWinGame Notice</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width" />
    <link type="text/css" href="../assets/css/style.css?v=20211021" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <script src="../assets/js/common.js?v=20200818"></script>
</head>
<body>
<!-- wrap -->
<div id="page">
    <section id="att_bg">
        <div class="basic_padding cs_name"><div><b>공지사항</b></div></div>
        <ul id="nav">
        </ul>
    </section>
</div>
<script>
    $(document).ready(function() {
        let drawNotice = function(json) {
            let today = getDatetimeString(new Date());
            $(json).each(function(index, notice) {

                // 예약게시 체크
                if (notice.status === "2") {
                    if ( (getTimeDiff(notice.reserve_start_date, today) < 0) || (getTimeDiff(today, notice.reserve_end_date) < 0) ) {
                        return false;
                    }
                }

                let border = (index === 0)? 2 : 1;
                let noticeLi = '<li style="border-top: '+ border +'px solid #f1f1f1;">' +
                    '<div class="basic_padding cs_title">' + notice.title + ' ' +
                    '<span>'+ notice.date.substr(0, 10).replace(/-/gi, '.') +'</span></div>' +
                    '<ul>' +
                    '<li>' +
                    '<div class="cs_contents">' + notice.contents + '</div>' +
                    '</li>' +
                    '</ul>' +
                    '</li>';

                $('#nav').append(noticeLi);
            });
        };

        // load json
        let jsoncache = Math.floor(+ new Date() / 1000);
        $.getJSON("../../storage/preview/notice.json?v="+jsoncache, function(json) {
            console.log(json);
            drawNotice(json);
        });
    });

    $(document).on('click', '#nav > li', function () {
        console.log($(this).find('ul').is(':hidden'));
        if($(this).find('ul').is(':hidden')){
            $('#nav ul').slideUp();
            $(this).find('ul').slideDown();
        } else {
            $(this).find('ul').slideUp();
        }
    });

    // $(function(){
    //     $('#nav > li').click(function(){
    //         if($('ul',this).is(':hidden')){
    //             $('#nav ul').slideUp();
    //             $('ul',this).slideDown();
    //         } else {
    //             $('ul',this).slideUp();
    //         }
    //     });
    // });
</script>
</body>
</html>
